!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.SubX=e():t.SubX=e()}(this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(t,e,n){(function(t,r){var o=/%[sdj%]/g;e.format=function(t){if(!_(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(c(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,u=String(t).replace(o,function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),s=r[n];n<i;s=r[++n])d(s)||!m(s)?u+=" "+s:u+=" "+c(s);return u},e.deprecate=function(n,o){if(v(t.process))return function(){return e.deprecate(n,o).apply(this,arguments)};if(!0===r.noDeprecation)return n;var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),i=!0}return n.apply(this,arguments)}};var i,u={};function c(t,n){var r={seen:[],stylize:a};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),y(n)?r.showHidden=n:n&&e._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=s),f(r,t,r.depth)}function s(t,e){var n=c.styles[e];return n?"["+c.colors[n][0]+"m"+t+"["+c.colors[n][1]+"m":t}function a(t,e){return t}function f(t,n,r){if(t.customInspect&&n&&E(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,t);return _(o)||(o=f(t,o,r)),o}var i=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(_(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(b(e))return t.stylize(""+e,"number");if(y(e))return t.stylize(""+e,"boolean");if(d(e))return t.stylize("null","null")}(t,n);if(i)return i;var u=Object.keys(n),c=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(u);if(t.showHidden&&(u=Object.getOwnPropertyNames(n)),S(n)&&(u.indexOf("message")>=0||u.indexOf("description")>=0))return l(n);if(0===u.length){if(E(n)){var s=n.name?": "+n.name:"";return t.stylize("[Function"+s+"]","special")}if(g(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return t.stylize(Date.prototype.toString.call(n),"date");if(S(n))return l(n)}var a,m="",j=!1,x=["{","}"];(h(n)&&(j=!0,x=["[","]"]),E(n))&&(m=" [Function"+(n.name?": "+n.name:"")+"]");return g(n)&&(m=" "+RegExp.prototype.toString.call(n)),w(n)&&(m=" "+Date.prototype.toUTCString.call(n)),S(n)&&(m=" "+l(n)),0!==u.length||j&&0!=n.length?r<0?g(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),a=j?function(t,e,n,r,o){for(var i=[],u=0,c=e.length;u<c;++u)T(e,String(u))?i.push(p(t,e,n,r,String(u),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(p(t,e,n,r,o,!0))}),i}(t,n,r,c,u):u.map(function(e){return p(t,n,r,c,e,j)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(a,m,x)):x[0]+m+x[1]}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,n,r,o,i){var u,c,s;if((s=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?c=s.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):s.set&&(c=t.stylize("[Setter]","special")),T(r,o)||(u="["+o+"]"),c||(t.seen.indexOf(s.value)<0?(c=d(n)?f(t,s.value,null):f(t,s.value,n-1)).indexOf("\n")>-1&&(c=i?c.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+c.split("\n").map(function(t){return"   "+t}).join("\n")):c=t.stylize("[Circular]","special")),v(u)){if(i&&o.match(/^\d+$/))return c;(u=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(u=u.substr(1,u.length-2),u=t.stylize(u,"name")):(u=u.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),u=t.stylize(u,"string"))}return u+": "+c}function h(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function d(t){return null===t}function b(t){return"number"==typeof t}function _(t){return"string"==typeof t}function v(t){return void 0===t}function g(t){return m(t)&&"[object RegExp]"===j(t)}function m(t){return"object"==typeof t&&null!==t}function w(t){return m(t)&&"[object Date]"===j(t)}function S(t){return m(t)&&("[object Error]"===j(t)||t instanceof Error)}function E(t){return"function"==typeof t}function j(t){return Object.prototype.toString.call(t)}function x(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(v(i)&&(i=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!u[t])if(new RegExp("\\b"+t+"\\b","i").test(i)){var n=r.pid;u[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else u[t]=function(){};return u[t]},e.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=h,e.isBoolean=y,e.isNull=d,e.isNullOrUndefined=function(t){return null==t},e.isNumber=b,e.isString=_,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=v,e.isRegExp=g,e.isObject=m,e.isDate=w,e.isError=S,e.isFunction=E,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(4);var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[x(t.getHours()),x(t.getMinutes()),x(t.getSeconds())].join(":");return[t.getDate(),O[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=n(5),e._extend=function(t,e){if(!e||!m(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,n(2),n(3))},,function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(t){r=u}}();var s,a=[],f=!1,l=-1;function p(){f&&s&&(f=!1,s.length?a=s.concat(a):l=-1,a.length&&h())}function h(){if(!f){var t=c(p);f=!0;for(var e=a.length;e;){for(s=a,a=[];++l<e;)s&&s[l].run();l=-1,e=a.length}s=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function d(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new y(t,e)),1!==a.length||f||c(h)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=d,o.addListener=d,o.once=d,o.off=d,o.removeListener=d,o.removeAllListeners=d,o.emit=d,o.prependListener=d,o.prependOnceListener=d,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";n.r(e);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function i(t){return"function"==typeof t}var u=!1,c={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;u=t},get useDeprecatedSynchronousErrorHandling(){return u}};function s(t){setTimeout(function(){throw t})}var a={closed:!0,next:function(t){},error:function(t){if(c.useDeprecatedSynchronousErrorHandling)throw t;s(t)},complete:function(){}},f=Array.isArray||function(t){return t&&"number"==typeof t.length};function l(t){return null!=t&&"object"==typeof t}var p,h={e:{}};function y(){try{return p.apply(this,arguments)}catch(t){return h.e=t,h}}function d(t){return p=t,y}function b(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}b.prototype=Object.create(Error.prototype);var _=b,v=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var n=this._parent,r=this._parents,o=this._unsubscribe,u=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var c=-1,s=r?r.length:0;n;)n.remove(this),n=++c<s&&r[c]||null;if(i(o))d(o).call(this)===h&&(e=!0,t=t||(h.e instanceof _?g(h.e.errors):[h.e]));if(f(u))for(c=-1,s=u.length;++c<s;){var a=u[c];if(l(a))if(d(a.unsubscribe).call(a)===h){e=!0,t=t||[];var p=h.e;p instanceof _?t=t.concat(g(p.errors)):t.push(p)}}if(e)throw new _(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var n=e;switch(typeof e){case"function":n=new t(e);case"object":if(n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if("function"!=typeof n._addParent){var r=n;(n=new t)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(n),n._addParent(this),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.prototype._addParent=function(t){var e=this._parent,n=this._parents;e&&e!==t?n?-1===n.indexOf(t)&&n.push(t):this._parents=[t]:this._parent=t},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function g(t){return t.reduce(function(t,e){return t.concat(e instanceof _?e.errors:e)},[])}var m="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),w=function(t){function e(n,r,o){var i=t.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,i._parentSubscription=null,arguments.length){case 0:i.destination=a;break;case 1:if(!n){i.destination=a;break}if("object"==typeof n){n instanceof e?(i.syncErrorThrowable=n.syncErrorThrowable,i.destination=n,n.add(i)):(i.syncErrorThrowable=!0,i.destination=new S(i,n));break}default:i.syncErrorThrowable=!0,i.destination=new S(i,n,r,o)}return i}return o(e,t),e.prototype[m]=function(){return this},e.create=function(t,n,r){var o=new e(t,n,r);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this._parentSubscription=null,this},e}(v),S=function(t){function e(e,n,r,o){var u,c=t.call(this)||this;c._parentSubscriber=e;var s=c;return i(n)?u=n:n&&(u=n.next,r=n.error,o=n.complete,n!==a&&(i((s=Object.create(n)).unsubscribe)&&c.add(s.unsubscribe.bind(s)),s.unsubscribe=c.unsubscribe.bind(c))),c._context=s,c._next=u,c._error=r,c._complete=o,c}return o(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;c.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,n=c.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):s(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;s(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};c.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),c.useDeprecatedSynchronousErrorHandling)throw t;s(t)}},e.prototype.__tryOrSetError=function(t,e,n){if(!c.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(e){return c.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(s(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(w);var E="function"==typeof Symbol&&Symbol.observable||"@@observable";function j(){}function x(t){return t?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:j}var O=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r=this.operator,o=function(t,e,n){if(t){if(t instanceof w)return t;if(t[m])return t[m]()}return t||e||n?new w(t,e,n):new w(a)}(t,e,n);if(r?r.call(o,this.source):o.add(this.source||c.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),c.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){c.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,n=e.closed,r=e.destination,o=e.isStopped;if(n||o)return!1;t=r&&r instanceof w?r:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=T(e))(function(e,r){var o;o=n.subscribe(function(e){try{t(e)}catch(t){r(t),o&&o.unsubscribe()}},r,e)})},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[E]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:x(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=T(t))(function(t,n){var r;e.subscribe(function(t){return r=t},function(t){return n(t)},function(){return t(r)})})},t.create=function(e){return new t(e)},t}();function T(t){if(t||(t=c.Promise||Promise),!t)throw new Error("no Promise impl found");return t}function A(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}A.prototype=Object.create(Error.prototype);var N=A,P=function(t){function e(e,n){var r=t.call(this)||this;return r.subject=e,r.subscriber=n,r.closed=!1,r}return o(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(v),$=function(t){function e(e){var n=t.call(this,e)||this;return n.destination=e,n}return o(e,t),e}(w),I=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return o(e,t),e.prototype[m]=function(){return new $(this)},e.prototype.lift=function(t){var e=new C(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new N;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),o=0;o<n;o++)r[o].next(t)},e.prototype.error=function(t){if(this.closed)throw new N;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),o=0;o<n;o++)r[o].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new N;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new N;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new N;return this.hasError?(t.error(this.thrownError),v.EMPTY):this.isStopped?(t.complete(),v.EMPTY):(this.observers.push(t),new P(this,t))},e.prototype.asObservable=function(){var t=new O;return t.source=this,t},e.create=function(t,e){return new C(t,e)},e}(O),C=function(t){function e(e,n){var r=t.call(this)||this;return r.destination=e,r.source=n,r}return o(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):v.EMPTY},e}(I);function D(t){return null!=t&&"object"==typeof t&&!0===t["@@functional/placeholder"]}function k(t){return function e(n){return 0===arguments.length||D(n)?e:t.apply(this,arguments)}}var z=k(function(t){return function(){return t}});function U(t){return function e(n,r){switch(arguments.length){case 0:return e;case 1:return D(n)?e:k(function(e){return t(n,e)});default:return D(n)&&D(r)?e:D(n)?k(function(e){return t(e,r)}):D(r)?k(function(e){return t(n,e)}):t(n,r)}}}function F(t,e){var n;t=t||[],e=e||[];var r=t.length,o=e.length,i=[];for(n=0;n<r;)i[i.length]=t[n],n+=1;for(n=0;n<o;)i[i.length]=e[n],n+=1;return i}function M(t,e){switch(t){case 0:return function(){return e.apply(this,arguments)};case 1:return function(t){return e.apply(this,arguments)};case 2:return function(t,n){return e.apply(this,arguments)};case 3:return function(t,n,r){return e.apply(this,arguments)};case 4:return function(t,n,r,o){return e.apply(this,arguments)};case 5:return function(t,n,r,o,i){return e.apply(this,arguments)};case 6:return function(t,n,r,o,i,u){return e.apply(this,arguments)};case 7:return function(t,n,r,o,i,u,c){return e.apply(this,arguments)};case 8:return function(t,n,r,o,i,u,c,s){return e.apply(this,arguments)};case 9:return function(t,n,r,o,i,u,c,s,a){return e.apply(this,arguments)};case 10:return function(t,n,r,o,i,u,c,s,a,f){return e.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function V(t,e,n){return function(){for(var r=[],o=0,i=t,u=0;u<e.length||o<arguments.length;){var c;u<e.length&&(!D(e[u])||o>=arguments.length)?c=e[u]:(c=arguments[o],o+=1),r[u]=c,D(c)||(i-=1),u+=1}return i<=0?n.apply(this,r):M(i,V(t,r,n))}}var H=U(function(t,e){return 1===t?k(e):M(t,V(t,[],e))});function Y(t){return function e(n,r,o){switch(arguments.length){case 0:return e;case 1:return D(n)?e:U(function(e,r){return t(n,e,r)});case 2:return D(n)&&D(r)?e:D(n)?U(function(e,n){return t(e,r,n)}):D(r)?U(function(e,r){return t(n,e,r)}):k(function(e){return t(n,r,e)});default:return D(n)&&D(r)&&D(o)?e:D(n)&&D(r)?U(function(e,n){return t(e,n,o)}):D(n)&&D(o)?U(function(e,n){return t(e,r,n)}):D(r)&&D(o)?U(function(e,r){return t(n,e,r)}):D(n)?k(function(e){return t(e,r,o)}):D(r)?k(function(e){return t(n,e,o)}):D(o)?k(function(e){return t(n,r,e)}):t(n,r,o)}}}var q=Y(function(t,e,n){if(e>=n.length||e<-n.length)return n;var r=(e<0?n.length:0)+e,o=F(n);return o[r]=t(n[r]),o}),L=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)};function R(t){return"function"==typeof t["@@transducer/step"]}function B(t,e,n){return function(){if(0===arguments.length)return n();var r=Array.prototype.slice.call(arguments,0),o=r.pop();if(!L(o)){for(var i=0;i<t.length;){if("function"==typeof o[t[i]])return o[t[i]].apply(o,r);i+=1}if(R(o))return e.apply(null,r)(o)}return n.apply(this,arguments)}}function X(t){return t&&t["@@transducer/reduced"]?t:{"@@transducer/value":t,"@@transducer/reduced":!0}}var J={init:function(){return this.xf["@@transducer/init"]()},result:function(t){return this.xf["@@transducer/result"](t)}};function G(t,e){for(var n=0,r=e.length,o=Array(r);n<r;)o[n]=t(e[n]),n+=1;return o}function K(t){return"[object String]"===Object.prototype.toString.call(t)}var Z=k(function(t){return!!L(t)||!!t&&("object"==typeof t&&(!K(t)&&(1===t.nodeType?!!t.length:0===t.length||t.length>0&&(t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1)))))}),W=function(){function t(t){this.f=t}return t.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},t.prototype["@@transducer/result"]=function(t){return t},t.prototype["@@transducer/step"]=function(t,e){return this.f(t,e)},t}();function Q(t){return new W(t)}var tt=U(function(t,e){return M(t.length,function(){return t.apply(e,arguments)})});function et(t,e,n){for(var r=n.next();!r.done;){if((e=t["@@transducer/step"](e,r.value))&&e["@@transducer/reduced"]){e=e["@@transducer/value"];break}r=n.next()}return t["@@transducer/result"](e)}function nt(t,e,n,r){return t["@@transducer/result"](n[r](tt(t["@@transducer/step"],t),e))}var rt="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";function ot(t,e,n){if("function"==typeof t&&(t=Q(t)),Z(n))return function(t,e,n){for(var r=0,o=n.length;r<o;){if((e=t["@@transducer/step"](e,n[r]))&&e["@@transducer/reduced"]){e=e["@@transducer/value"];break}r+=1}return t["@@transducer/result"](e)}(t,e,n);if("function"==typeof n["fantasy-land/reduce"])return nt(t,e,n,"fantasy-land/reduce");if(null!=n[rt])return et(t,e,n[rt]());if("function"==typeof n.next)return et(t,e,n);if("function"==typeof n.reduce)return nt(t,e,n,"reduce");throw new TypeError("reduce: list must be array or iterable")}var it=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=J.init,t.prototype["@@transducer/result"]=J.result,t.prototype["@@transducer/step"]=function(t,e){return this.xf["@@transducer/step"](t,this.f(e))},t}(),ut=U(function(t,e){return new it(t,e)});function ct(t,e){return Object.prototype.hasOwnProperty.call(e,t)}var st=Object.prototype.toString,at=function(){return"[object Arguments]"===st.call(arguments)?function(t){return"[object Arguments]"===st.call(t)}:function(t){return ct("callee",t)}},ft=!{toString:null}.propertyIsEnumerable("toString"),lt=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],pt=function(){return arguments.propertyIsEnumerable("length")}(),ht=function(t,e){for(var n=0;n<t.length;){if(t[n]===e)return!0;n+=1}return!1},yt=k("function"!=typeof Object.keys||pt?function(t){if(Object(t)!==t)return[];var e,n,r=[],o=pt&&at(t);for(e in t)!ct(e,t)||o&&"length"===e||(r[r.length]=e);if(ft)for(n=lt.length-1;n>=0;)ct(e=lt[n],t)&&!ht(r,e)&&(r[r.length]=e),n-=1;return r}:function(t){return Object(t)!==t?[]:Object.keys(t)}),dt=U(B(["fantasy-land/map","map"],ut,function(t,e){switch(Object.prototype.toString.call(e)){case"[object Function]":return H(e.length,function(){return t.call(this,e.apply(this,arguments))});case"[object Object]":return ot(function(n,r){return n[r]=t(e[r]),n},{},yt(e));default:return G(t,e)}})),bt=U(function(t,e){for(var n=e,r=0;r<t.length;){if(null==n)return;n=n[t[r]],r+=1}return n}),_t=Y(ot);var vt=U(function(t,e){return F(e,[t])}),gt=Y(function(t,e,n){var r={};for(var o in n)r[o]=n[o];return r[t]=e,r});Number.isInteger;function mt(t){return"[object Function]"===Object.prototype.toString.call(t)}var wt=k(function(t){return null===t?"Null":void 0===t?"Undefined":Object.prototype.toString.call(t).slice(8,-1)});function St(t,e){return function(){return e.call(this,t.apply(this,arguments))}}function Et(t,e){return function(){var n=arguments.length;if(0===n)return e();var r=arguments[n-1];return L(r)||"function"!=typeof r[t]?e.apply(this,arguments):r[t].apply(r,Array.prototype.slice.call(arguments,0,n-1))}}var jt=Y(Et("slice",function(t,e,n){return Array.prototype.slice.call(n,t,e)})),xt=k(Et("tail",jt(1,1/0)));function Ot(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return M(arguments[0].length,_t(St,arguments[0],xt(arguments)))}function Tt(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function At(t,e,n){for(var r=0,o=n.length;r<o;){if(t(e,n[r]))return!0;r+=1}return!1}var Nt=U(function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e});function Pt(t,e,n,r){var o=Tt(t);function i(t,e){return $t(t,e,n.slice(),r.slice())}return!At(function(t,e){return!At(i,e,t)},Tt(e),o)}function $t(t,e,n,r){if(Nt(t,e))return!0;var o=wt(t);if(o!==wt(e))return!1;if(null==t||null==e)return!1;if("function"==typeof t["fantasy-land/equals"]||"function"==typeof e["fantasy-land/equals"])return"function"==typeof t["fantasy-land/equals"]&&t["fantasy-land/equals"](e)&&"function"==typeof e["fantasy-land/equals"]&&e["fantasy-land/equals"](t);if("function"==typeof t.equals||"function"==typeof e.equals)return"function"==typeof t.equals&&t.equals(e)&&"function"==typeof e.equals&&e.equals(t);switch(o){case"Arguments":case"Array":case"Object":if("function"==typeof t.constructor&&"Promise"===function(t){var e=String(t).match(/^function (\w*)/);return null==e?"":e[1]}(t.constructor))return t===e;break;case"Boolean":case"Number":case"String":if(typeof t!=typeof e||!Nt(t.valueOf(),e.valueOf()))return!1;break;case"Date":if(!Nt(t.valueOf(),e.valueOf()))return!1;break;case"Error":return t.name===e.name&&t.message===e.message;case"RegExp":if(t.source!==e.source||t.global!==e.global||t.ignoreCase!==e.ignoreCase||t.multiline!==e.multiline||t.sticky!==e.sticky||t.unicode!==e.unicode)return!1}for(var i=n.length-1;i>=0;){if(n[i]===t)return r[i]===e;i-=1}switch(o){case"Map":return t.size===e.size&&Pt(t.entries(),e.entries(),n.concat([t]),r.concat([e]));case"Set":return t.size===e.size&&Pt(t.values(),e.values(),n.concat([t]),r.concat([e]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var u=yt(t);if(u.length!==yt(e).length)return!1;var c=n.concat([t]),s=r.concat([e]);for(i=u.length-1;i>=0;){var a=u[i];if(!ct(a,e)||!$t(e[a],t[a],c,s))return!1;i-=1}return!0}var It=U(function(t,e){return $t(t,e,[],[])});function Ct(t,e,n){var r,o;if("function"==typeof t.indexOf)switch(typeof e){case"number":if(0===e){for(r=1/e;n<t.length;){if(0===(o=t[n])&&1/o===r)return n;n+=1}return-1}if(e!=e){for(;n<t.length;){if("number"==typeof(o=t[n])&&o!=o)return n;n+=1}return-1}return t.indexOf(e,n);case"string":case"boolean":case"function":case"undefined":return t.indexOf(e,n);case"object":if(null===e)return t.indexOf(e,n)}for(;n<t.length;){if(It(t[n],e))return n;n+=1}return-1}function Dt(t,e){return Ct(e,t,0)>=0}function kt(t){return'"'+t.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0").replace(/"/g,'\\"')+'"'}var zt=function(t){return(t<10?"0":"")+t},Ut="function"==typeof Date.prototype.toISOString?function(t){return t.toISOString()}:function(t){return t.getUTCFullYear()+"-"+zt(t.getUTCMonth()+1)+"-"+zt(t.getUTCDate())+"T"+zt(t.getUTCHours())+":"+zt(t.getUTCMinutes())+":"+zt(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"};function Ft(t){return function(){return!t.apply(this,arguments)}}function Mt(t,e){for(var n=0,r=e.length,o=[];n<r;)t(e[n])&&(o[o.length]=e[n]),n+=1;return o}function Vt(t){return"[object Object]"===Object.prototype.toString.call(t)}var Ht=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=J.init,t.prototype["@@transducer/result"]=J.result,t.prototype["@@transducer/step"]=function(t,e){return this.f(e)?this.xf["@@transducer/step"](t,e):t},t}(),Yt=U(B(["filter"],U(function(t,e){return new Ht(t,e)}),function(t,e){return Vt(e)?ot(function(n,r){return t(e[r])&&(n[r]=e[r]),n},{},yt(e)):Mt(t,e)})),qt=U(function(t,e){return Yt(Ft(t),e)});var Lt=k(function(t){return function t(e,n){var r=function(r){var o=n.concat([e]);return Dt(r,o)?"<Circular>":t(r,o)},o=function(t,e){return G(function(e){return kt(e)+": "+r(t[e])},e.slice().sort())};switch(Object.prototype.toString.call(e)){case"[object Arguments]":return"(function() { return arguments; }("+G(r,e).join(", ")+"))";case"[object Array]":return"["+G(r,e).concat(o(e,qt(function(t){return/^\d+$/.test(t)},yt(e)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof e?"new Boolean("+r(e.valueOf())+")":e.toString();case"[object Date]":return"new Date("+(isNaN(e.valueOf())?r(NaN):kt(Ut(e)))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof e?"new Number("+r(e.valueOf())+")":1/e==-1/0?"-0":e.toString(10);case"[object String]":return"object"==typeof e?"new String("+r(e.valueOf())+")":kt(e);case"[object Undefined]":return"undefined";default:if("function"==typeof e.toString){var i=e.toString();if("[object Object]"!==i)return i}return"{"+o(e,yt(e)).join(", ")+"}"}}(t,[])}),Rt=U(function(t,e){if(L(t)){if(L(e))return t.concat(e);throw new TypeError(Lt(e)+" is not an array")}if(K(t)){if(K(e))return t+e;throw new TypeError(Lt(e)+" is not a string")}if(null!=t&&mt(t["fantasy-land/concat"]))return t["fantasy-land/concat"](e);if(null!=t&&mt(t.concat))return t.concat(e);throw new TypeError(Lt(t)+' does not have a method named "concat" or "fantasy-land/concat"')}),Bt=Y(function(t,e,n){return q(z(e),t,n)}),Xt=function(){function t(t,e){this.xf=e,this.n=t,this.i=0}return t.prototype["@@transducer/init"]=J.init,t.prototype["@@transducer/result"]=J.result,t.prototype["@@transducer/step"]=function(t,e){this.i+=1;var n=0===this.n?t:this.xf["@@transducer/step"](t,e);return this.n>=0&&this.i>=this.n?X(n):n},t}(),Jt=U(B(["take"],U(function(t,e){return new Xt(t,e)}),function(t,e){return jt(0,t<0?1/0:t,e)}));var Gt=U(function(t,e){var n=t<0?e.length+t:t;return K(e)?e.charAt(n):e[n]}),Kt=Gt(-1),Zt=k(function(t){return null!=t&&"function"==typeof t["fantasy-land/empty"]?t["fantasy-land/empty"]():null!=t&&null!=t.constructor&&"function"==typeof t.constructor["fantasy-land/empty"]?t.constructor["fantasy-land/empty"]():null!=t&&"function"==typeof t.empty?t.empty():null!=t&&null!=t.constructor&&"function"==typeof t.constructor.empty?t.constructor.empty():L(t)?[]:K(t)?"":Vt(t)?{}:at(t)?function(){return arguments}():void 0}),Wt=k(function(t){return H(t.length,function(e,n){var r=Array.prototype.slice.call(arguments,0);return r[0]=n,r[1]=e,t.apply(this,r)})}),Qt=U(Et("forEach",function(t,e){for(var n=e.length,r=0;r<n;)t(e[r]),r+=1;return e})),te=k(function(t){for(var e={},n=0;n<t.length;)e[t[n][0]]=t[n][1],n+=1;return e});function ee(t){return t}var ne=jt(0,-1);function re(t,e,n){var r,o=typeof t;switch(o){case"string":case"number":return 0===t&&1/t==-1/0?!!n._items["-0"]||(e&&(n._items["-0"]=!0),!1):null!==n._nativeSet?e?(r=n._nativeSet.size,n._nativeSet.add(t),n._nativeSet.size===r):n._nativeSet.has(t):o in n._items?t in n._items[o]||(e&&(n._items[o][t]=!0),!1):(e&&(n._items[o]={},n._items[o][t]=!0),!1);case"boolean":if(o in n._items){var i=t?1:0;return!!n._items[o][i]||(e&&(n._items[o][i]=!0),!1)}return e&&(n._items[o]=t?[!1,!0]:[!0,!1]),!1;case"function":return null!==n._nativeSet?e?(r=n._nativeSet.size,n._nativeSet.add(t),n._nativeSet.size===r):n._nativeSet.has(t):o in n._items?!!Dt(t,n._items[o])||(e&&n._items[o].push(t),!1):(e&&(n._items[o]=[t]),!1);case"undefined":return!!n._items[o]||(e&&(n._items[o]=!0),!1);case"object":if(null===t)return!!n._items.null||(e&&(n._items.null=!0),!1);default:return(o=Object.prototype.toString.call(t))in n._items?!!Dt(t,n._items[o])||(e&&n._items[o].push(t),!1):(e&&(n._items[o]=[t]),!1)}}var oe=function(){function t(){this._nativeSet="function"==typeof Set?new Set:null,this._items={}}return t.prototype.add=function(t){return!re(t,!0,this)},t.prototype.has=function(t){return re(t,!1,this)},t}(),ie=U(function(t,e){for(var n,r,o=new oe,i=[],u=0;u<e.length;)n=t(r=e[u]),o.add(n)&&i.push(r),u+=1;return i});var ue="function"==typeof Object.assign?Object.assign:function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1,r=arguments.length;n<r;){var o=arguments[n];if(null!=o)for(var i in o)ct(i,o)&&(e[i]=o[i]);n+=1}return e},ce=U(function(t,e){var n={};return n[t]=e,n});Array,String,Object;var se=U(function(t,e){return It(Jt(t.length,e),t)});var ae="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",fe=(String.prototype.trim,U(function(t,e){return qt(Wt(Dt)(t),e)})),le=n(0),pe=n.n(le);var he=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parent=e,o.outerValue=n,o.outerIndex=r,o.index=0,o}return o(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(w),ye=function(t){return function(e){for(var n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.closed||e.complete()}},de=function(t){return function(e){return t.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,s),e}};var be=function(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}(),_e=function(t){return function(e){for(var n=t[be]();;){var r=n.next();if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add(function(){n.return&&n.return()}),e}},ve=function(t){return function(e){var n=t[E]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)}},ge=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function me(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var we=function(t){if(t instanceof O)return function(e){return t._isScalar?(e.next(t.value),void e.complete()):t.subscribe(e)};if(t&&"function"==typeof t[E])return ve(t);if(ge(t))return ye(t);if(me(t))return de(t);if(t&&"function"==typeof t[be])return _e(t);var e=l(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function Se(t,e,n,r,o){if(void 0===o&&(o=new he(t,n,r)),!o.closed)return we(e)(o)}var Ee=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.notifyNext=function(t,e,n,r,o){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(w);var je=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new xe(t,this.project,this.thisArg))},t}(),xe=function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.project=n,o.count=0,o.thisArg=r||o,o}return o(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(w);function Oe(t,e){return new O(e?function(n){var r=new v,o=0;return r.add(e.schedule(function(){o!==t.length?(n.next(t[o++]),n.closed||r.add(this.schedule())):n.complete()})),r}:ye(t))}function Te(t,e){if(!e)return t instanceof O?t:new O(we(t));if(null!=t){if(function(t){return t&&"function"==typeof t[E]}(t))return function(t,e){return new O(e?function(n){var r=new v;return r.add(e.schedule(function(){var o=t[E]();r.add(o.subscribe({next:function(t){r.add(e.schedule(function(){return n.next(t)}))},error:function(t){r.add(e.schedule(function(){return n.error(t)}))},complete:function(){r.add(e.schedule(function(){return n.complete()}))}}))})),r}:ve(t))}(t,e);if(me(t))return function(t,e){return new O(e?function(n){var r=new v;return r.add(e.schedule(function(){return t.then(function(t){r.add(e.schedule(function(){n.next(t),r.add(e.schedule(function(){return n.complete()}))}))},function(t){r.add(e.schedule(function(){return n.error(t)}))})})),r}:de(t))}(t,e);if(ge(t))return Oe(t,e);if(function(t){return t&&"function"==typeof t[be]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new O(e?function(n){var r,o=new v;return o.add(function(){r&&"function"==typeof r.return&&r.return()}),o.add(e.schedule(function(){r=t[be](),o.add(e.schedule(function(){if(!n.closed){var t,e;try{var o=r.next();t=o.value,e=o.done}catch(t){return void n.error(t)}e?n.complete():(n.next(t),this.schedule())}}))})),o}:_e(t))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function Ae(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?function(r){return r.pipe(Ae(function(n,r){return Te(t(n,r)).pipe(function(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new je(t,e))}}(function(t,o){return e(n,t,r,o)}))},n))}:("number"==typeof e&&(n=e),function(e){return e.lift(new Ne(t,n))})}var Ne=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new Pe(t,this.project,this.concurrent))},t}(),Pe=function(t){function e(e,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var o=t.call(this,e)||this;return o.project=n,o.concurrent=r,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return o(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,n)},e.prototype._innerSub=function(t,e,n){var r=new he(this,void 0,void 0);this.destination.add(r),Se(this,t,e,n,r)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t,e,n,r,o){this.destination.next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(Ee);function $e(t){return t}function Ie(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Number.POSITIVE_INFINITY,r=null,o=t[t.length-1];return!function(t){return t&&"function"==typeof t.schedule}(o)?"number"==typeof o&&(n=t.pop()):(r=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())),null===r&&1===t.length&&t[0]instanceof O?t[0]:function(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),Ae($e,t)}(n)(Oe(t,r))}var Ce=function(t){function e(e){var n=t.call(this)||this;return n._value=e,n}return o(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new N;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(I);function De(t,e){return function(n){return n.lift(new ke(t,e))}}var ke=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new ze(t,this.predicate,this.thisArg))},t}(),ze=function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.predicate=n,o.thisArg=r,o.count=0,o}return o(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(w);var Ue=function(){function t(t,e){this.keySelector=t,this.flushes=e}return t.prototype.call=function(t,e){return e.subscribe(new Fe(t,this.keySelector,this.flushes))},t}(),Fe=function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.keySelector=n,o.values=new Set,r&&o.add(Se(o,r)),o}return o(e,t),e.prototype.notifyNext=function(t,e,n,r,o){this.values.clear()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype._next=function(t){this.keySelector?this._useKeySelector(t):this._finalizeNext(t,t)},e.prototype._useKeySelector=function(t){var e,n=this.destination;try{e=this.keySelector(t)}catch(t){return void n.error(t)}this._finalizeNext(e,t)},e.prototype._finalizeNext=function(t,e){var n=this.values;n.has(t)||(n.add(t),this.destination.next(e))},e}(Ee);var Me=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var n=this.connectable;n._refCount++;var r=new Ve(t,n),o=e.subscribe(r);return r.closed||(r.connection=n.connect()),o},t}(),Ve=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return o(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var n=this.connection,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},e}(w),He=function(t){function e(e,n){var r=t.call(this)||this;return r.source=e,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return o(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new v).add(this.source.subscribe(new qe(this.getSubject(),this))),t.closed?(this._connection=null,t=v.EMPTY):this._connection=t),t},e.prototype.refCount=function(){return function(t){return t.lift(new Me(t))}(this)},e}(O).prototype,Ye={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:He._subscribe},_isComplete:{value:He._isComplete,writable:!0},getSubject:{value:He.getSubject},connect:{value:He.connect},refCount:{value:He.refCount}},qe=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return o(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}($);function Le(t,e){return function(n){var r;if(r="function"==typeof t?t:function(){return t},"function"==typeof e)return n.lift(new Re(r,e));var o=Object.create(n,Ye);return o.source=n,o.subjectFactory=r,o}}var Re=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var n=this.selector,r=this.subjectFactory(),o=n(r).subscribe(t);return o.add(e.subscribe(r)),o},t}();function Be(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}Be.prototype=Object.create(Error.prototype);var Xe=Be;function Je(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}Je.prototype=Object.create(Error.prototype);var Ge=Je,Ke=new O(function(t){return t.complete()});function Ze(t){return t?function(t){return new O(function(e){return t.schedule(function(){return e.complete()})})}(t):Ke}var We=function(){function t(t){if(this.total=t,this.total<0)throw new Ge}return t.prototype.call=function(t,e){return e.subscribe(new Qe(t,this.total))},t}(),Qe=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.count=0,r}return o(e,t),e.prototype._next=function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))},e}(w);var tn=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new en(t,this.defaultValue))},t}(),en=function(t){function e(e,n){var r=t.call(this,e)||this;return r.defaultValue=n,r.isEmpty=!0,r}return o(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(w);var nn=function(){function t(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}return t.prototype.call=function(t,e){return e.subscribe(new rn(t,this.nextOrObserver,this.error,this.complete))},t}(),rn=function(t){function e(e,n,r,o){var u=t.call(this,e)||this;return u._tapNext=j,u._tapError=j,u._tapComplete=j,u._tapError=r||j,u._tapComplete=o||j,i(n)?(u._context=u,u._tapNext=n):n&&(u._context=n,u._tapNext=n.next||j,u._tapError=n.error||j,u._tapComplete=n.complete||j),u}return o(e,t),e.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},e.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},e}(w),on=function(t){return void 0===t&&(t=un),function(t,e,n){return function(r){return r.lift(new nn(t,e,n))}}({hasValue:!1,next:function(){this.hasValue=!0},complete:function(){if(!this.hasValue)throw t()}})};function un(){return new Xe}function cn(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?De(function(e,n){return t(e,n,r)}):$e,function(t){return function(e){return 0===t?Ze():e.lift(new We(t))}}(1),n?function(t){return void 0===t&&(t=null),function(e){return e.lift(new tn(t))}}(e):on(function(){return new Xe}))}}let sn=(new Date).valueOf();var an=()=>++sn;const fn=(t,e)=>{const n=bt(e.path,t);return r=>{if("STALE"===r.type&&It(r.path,e.path))return!0;if("DELETE"===r.type&&void 0!==n&&It(r.path,e.path))return!0;if("SET"===r.type&&se(r.path,e.path)){const r=bt(ne(e.path),t);if("object"==typeof r&&null!==r)return n!==r[Kt(e.path)]}return!1}},ln=(t,e)=>{const n=Kt(e.path)in bt(ne(e.path),t);return r=>{if("DELETE"===r.type&&!0===n&&It(r.path,e.path))return!0;if("SET"===r.type&&se(r.path,e.path)){const r=bt(ne(e.path),t);if("object"==typeof r&&null!==r)return Kt(e.path)in r!==n}return!1}},pn=(t,e)=>{const n=Object.keys(bt(e.path,t));return r=>{if("DELETE"===r.type&&e.path.length+1===r.path.length&&se(e.path,r.path)||"SET"===r.type&&(se(r.path,e.path)||e.path.length+1===r.path.length&&se(e.path,r.path))){const r=bt(e.path,t);if("object"==typeof r&&null!==r)return!It(Object.keys(r),n)}return!1}},hn=t=>_t((t,e)=>{if(0===t.length)return[e];const n=Kt(t);if(e.id===n.id){let r,o;e.path.length>n.path.length?(r=e,o=n):(r=n,o=e);const i=t.length>1?Kt(ne(t)):{path:[void 0]},u=se(i.path,r.path)?r:o;return u!==n?[...ne(t),u]:t}return vt(e,t)})([],t),yn=(t,{gets:e,hass:n,keyss:r})=>Ie(...((t,e)=>{const n=_t((t,e)=>t.length>0&&se(Kt(t).path,e.path)?Bt(t.length-1,e,t):vt(e,t))([],e),r=ie(t=>t.path.join("."),n),o=[];return Qt(e=>{const n=fn(t,e);o.push(Ie(t.stale$,t.delete$,t.set$).pipe(De(t=>n(t)))),o.push(t.transaction$.pipe(De(t=>t.events.map(e=>gt("path",[...t.path,...e.path],e)).some(t=>n(t)))))},r),o})(t,hn(e)),...((t,e)=>{const n=ie(t=>t.path.join("."),e),r=[];return Qt(e=>{const n=ln(t,e);r.push(Ie(t.delete$,t.set$).pipe(De(t=>n(t)))),r.push(t.transaction$.pipe(De(t=>t.events.map(e=>gt("path",[...t.path,...e.path],e)).some(t=>n(t)))))},n),r})(t,hn(n)),...((t,e)=>{const n=ie(t=>t.path.join("."),e),r=[];return Qt(e=>{const n=pn(t,e);r.push(Ie(t.delete$,t.set$).pipe(De(t=>n(t)))),r.push(t.transaction$.pipe(De(t=>t.events.map(e=>gt("path",[...t.path,...e.path],e)).some(t=>n(t)))))},n),r})(t,hn(r))).pipe(function(t,e){return function(n){return n.lift(new Ue(t,e))}}(),function(t){return t?Le(function(){return new I},t):Le(new I)}()).refCount(),dn=(t,e)=>{const n=[],r=[],o=[];let i=0;const u=new v;u.add(t.get$.subscribe(t=>1===i&&n.push(t))),u.add(t.has$.subscribe(t=>1===i&&r.push(t))),u.add(t.keys$.subscribe(t=>1===i&&o.push(t))),u.add(t.compute_begin$.subscribe(t=>{i+=1})),u.add(t.compute_finish$.subscribe(t=>{i-=1})),i+=1;const c=e();return i-=1,u.unsubscribe(),{result:c,stream$:yn(t,{gets:n,hass:r,keyss:o})}},bn=(t,e)=>{const n=Kt(e.name.split(" "));let r,o=!0;return()=>{if(o){t.__emitEvent__("compute_begin$",{type:"COMPUTE_BEGIN",path:[n],id:an()});const{result:i,stream$:u}=dn(t,e.bind(t));r=i,o=!1,u.pipe(cn()).subscribe(e=>{o=!0,t.__emitEvent__("stale$",{type:"STALE",path:[n],cache:r,id:an()})}),t.__emitEvent__("compute_finish$",{type:"COMPUTE_FINISH",path:[n],id:an()})}return r}},_n=["set$","delete$","get$","has$","keys$","compute_begin$","compute_finish$","stale$","transaction$"],vn=["$","__isSubX__","__id__","__emitEvent__","__parents__","__cache__",..._n],gn=t=>({set:(e,n,r,o)=>{-1!==vn.indexOf(n)&&(n=`_${n}`);const i=e[n];if(t||null===r||"object"!=typeof r)return e[n]=r,e.__emitEvent__("set$",{type:"SET",path:[n],id:an()}),!0;const u=r.__isSubX__?r:mn.create(r);return e[n]=u,u.__parents__[e.__id__+":"+n]=[e,n],i&&i.__isSubX__&&delete i.__parents__[e.__id__+":"+n],e.__emitEvent__("set$",{type:"SET",path:[n],id:an()}),!0},get:(t,e,n)=>{switch(e){case"__isSubX__":return!0;case"toJSON":return()=>Array.isArray(t)?n:Ot(yt,Yt(t=>-1===vn.indexOf(t)&&"value"in Object.getOwnPropertyDescriptor(n,t)&&"function"!=typeof n[t]),dt(t=>[t,n[t]]),te)(n);case"toString":return()=>"[object SubX]";case pe.a.inspect.custom:return()=>Array.isArray(t)?n:Ot(yt,qt(t=>-1!==vn.indexOf(t)),_t((t,e)=>Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e)))({}))(n);case"startTransaction":return()=>{t.__cache__=[]};case"endTransaction":return e=>{const n={type:"TRANSACTION",name:e,path:[],events:t.__cache__,id:an()};delete t.__cache__,e&&(n.name=e),t.__emitEvent__("transaction$",n)};case"copyWithin":case"fill":case"pop":case"push":case"reverse":case"shift":case"sort":case"splice":case"unshift":if(Array.isArray(t)){return(...r)=>{n.startTransaction();const o=t[e].bind(n)(...r);return n.endTransaction(e),o}}return t[e];default:const r=t[e];return"function"!=typeof r&&-1===vn.indexOf(e)&&t.__emitEvent__("get$",{type:"GET",path:[e],id:an()}),r}},deleteProperty:(t,e)=>{if(-1!==vn.indexOf(e))return!1;const n=t[e];return delete t[e],n&&n.__isSubX__&&delete n.__parents__[t.__id__+":"+e],t.__emitEvent__("delete$",{type:"DELETE",path:[e],id:an()}),!0},has:(t,e)=>(t.__emitEvent__("has$",{type:"HAS",path:[e],id:an()}),e in t),ownKeys:t=>(t.__emitEvent__("keys$",{type:"KEYS",path:[],id:an()}),fe(vn,Object.getOwnPropertyNames(t))),setPrototypeOf:(t,e)=>!1,defineProperty:(t,e,n)=>!1,preventExtensions:t=>!1});class mn{constructor(t={},e=!1){return class{constructor(n={}){const r=Zt(n);Qt(t=>{r[t]=new I},_n),r.$=r.set$,r.__id__=an(),r.__parents__={},r.__emitEvent__=((t,e)=>{r.__cache__?"SET"!==e.type&&"DELETE"!==e.type||r.__cache__.push(e):(r[t].observers.length>0&&r[t].next(e),Object.keys(r.__parents__).forEach(n=>{const[o,i]=r.__parents__[n];o.__emitEvent__(t,gt("path",[i,...e.path],e))}))});const o=new Proxy(r,gn(e));return Ot(Rt(dt(e=>[t,e],yt(t))),Qt(([t,e])=>{const n=Object.getOwnPropertyDescriptor(t,e);"value"in n?o[e]=t[e]:"get"in n&&(n.get=bn(o,n.get),Object.defineProperty(r,e,n))}))(dt(t=>[n,t],yt(n))),o}}}}const wn=new mn({});mn.create=((t={})=>new wn(t)),mn.runAndMonitor=dn,mn.autoRun=((t,e,...n)=>{let r,o;const i=()=>{const{result:u,stream$:c}=dn(t,e);r?r.next(u):r=new Ce(u),o=c.pipe(...n,cn()).subscribe(t=>i())};return i(),r.subscribe(void 0,void 0,()=>{o.unsubscribe()}),r});e.default=mn}]).default});
//# sourceMappingURL=main.js.map